<script>
  var stripe = Stripe('pk_test_qfH2BOWhxkEXfcL99c6RhRR300QJqMIBMZ');

  var checkoutButton = document.querySelector('#checkout-button');
  checkoutButton.addEventListener('click', function () {
    stripe.redirectToCheckout({
      items: [{
        // Define the product and SKU in the Dashboard first, and use the SKU
        // ID in your client-side code.
        sku: 'sku_123',
        quantity: 1
      }],
      successUrl: 'https://www.example.com/success',
      cancelUrl: 'https://www.example.com/cancel'
    });
  });
</script>

<div class="row">
  <div class="col-md">
    <h2><%= @course.title %></h2>
    <ul class="list-group">
      <li class="list-group-item"><strong>Desc:</strong> <%= @course.description %></li>
      <li class="list-group-item"><strong>Category:</strong> <%= @course.category %></li>
      <li class="list-group-item"><strong>Price:</strong> <%= "Â£" + "#{@course.price}" %></li>
    </ul>
    <div class="row" style='padding: 15px 0 0 0'>
      <div class='col-md'>
        <% if user_signed_in? && current_user.courses[@course.id] %>
          <p class='lead'><%= "You are signed up to this course, congratulations!!!" %></p>
          <% if @course.stations.any? %>
            <ul class="list-group">
              <% @course.stations.each do |station| %>
              <li class="list-group-item">
                <%= link_to station.title, station_path(station) %>
              </li>
              <% end %>
            </ul>
          <% end %>
        <% else %>
          <%= link_to "Sign up for this course", payments_path(course: @course), class:"btn btn-primary", method: :post %>
        <% end %>
      </div>
    </div>
  </div>
</div>
